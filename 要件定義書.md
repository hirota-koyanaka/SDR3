# 里山ドッグラン管理システム 要件定義書

## 1. プロジェクト概要

### 1.1 システム名称
里山ドッグラン管理システム

### 1.2 目的
愛媛県今治市にある「里山ドッグラン」の管理・運営を効率化し、利用者への利便性を向上させるためのWebアプリケーションシステムを構築する。

### 1.3 背景
- ドッグラン施設の利用者管理と予約システムの必要性
- 利用者同士のコミュニティ形成と情報共有の促進
- 施設運営の効率化とデジタル化の推進

### 1.4 利用対象者
- **一般利用者**: ドッグランを利用する犬の飼い主
- **管理者**: 施設の運営・管理を行うスタッフ
- **スーパー管理者**: システム全体の管理権限を持つ管理者

## 2. システム構成

### 2.1 技術スタック

#### バックエンド
- **フレームワーク**: FastAPI (Python)
- **ORM**: SQLAlchemy
- **認証**: JWT (JSON Web Token)
- **データベース**: 
  - 開発環境: SQLite
  - 本番環境: Azure MySQL

#### フロントエンド
- **フレームワーク**: Next.js 14 (TypeScript)
- **UIライブラリ**: Radix UI
- **スタイリング**: Tailwind CSS
- **状態管理**: React Context API
- **通信**: Axios

### 2.2 デプロイメント環境
- **フロントエンド**: Azure Web Apps
- **バックエンド**: Azure Web Apps
- **データベース**: Azure Database for MySQL

## 3. 機能要件

### 3.1 認証・ユーザー管理機能

#### 3.1.1 ユーザー登録・申請機能
- **利用申請フォーム**
  - 氏名、メールアドレス、電話番号、住所の入力
  - 今治市民確認（居住年数）
  - パスワード設定
  - 犬情報の登録（名前、犬種、体重、性格）
  - ワクチン接種証明書のアップロード
  - 希望利用日時の選択

- **申請状況確認**
  - 申請ID発行
  - 承認状況の確認（pending/approved/rejected）
  - 却下理由の表示

#### 3.1.2 ログイン機能
- メールアドレス・パスワードによる認証
- JWTトークンによるセッション管理
- パスワードリセット機能

#### 3.1.3 プロフィール管理
- ユーザー情報の編集
- 犬情報の追加・編集・削除
- ワクチン接種履歴の管理

### 3.2 管理者機能

#### 3.2.1 ダッシュボード
- 統計情報の表示
  - 総ユーザー数
  - 総登録犬数
  - 承認待ち申請数
  - イベント数
  - お知らせ数

#### 3.2.2 申請管理
- 申請一覧表示（フィルタリング機能付き）
- 申請詳細確認
- 承認/却下処理
- 管理者メモの追加
- 承認時の自動ユーザー作成

#### 3.2.3 ユーザー管理
- ユーザー一覧表示
- ユーザー詳細情報確認
- ユーザーアカウントの一時停止/復活
- ユーザー統計（新規登録数、アクティブユーザー数など）

#### 3.2.4 投稿管理
- 投稿の承認/却下
- 不適切な投稿の削除
- 投稿ステータス管理（pending/approved/rejected/reported）

#### 3.2.5 イベント管理
- イベントの作成・編集・削除
- 参加者管理
- 定員設定と参加費管理

#### 3.2.6 お知らせ管理
- お知らせの作成・編集・削除
- 優先度設定（low/normal/high/urgent）
- 公開期限設定

#### 3.2.7 営業時間管理
- 曜日別営業時間の設定
- 特別休業日の設定
- 臨時営業時間の変更

#### 3.2.8 システム設定
- 各種システムパラメータの管理
- 設定のバックアップ・復元

### 3.3 一般利用者機能

#### 3.3.1 ホーム画面
- ログイン/新規登録
- 施設紹介
- 利用規約の表示
- 申請状況確認

#### 3.3.2 イベントカレンダー
- 月別カレンダー表示
- イベント一覧
- イベント詳細確認
- イベント参加申込

#### 3.3.3 SNS機能（フィード）
- 投稿の作成（テキスト、画像、ハッシュタグ）
- 投稿の閲覧・検索
- いいね機能
- コメント機能
- カテゴリー別フィルタリング

#### 3.3.4 入場管理
- QRコード生成
- 入場登録（犬の選択）
- 退場処理
- 現在の利用者確認

#### 3.3.5 マイページ
- プロフィール情報の表示・編集
- 登録犬情報の管理
- 利用履歴の確認
- ログアウト

### 3.4 通知機能
- お知らせの表示
- 未読件数の表示
- 既読/未読管理

## 4. データモデル

### 4.1 主要テーブル

#### ユーザー関連
- **users**: ユーザー基本情報
- **admin_users**: 管理者アカウント
- **applications**: 利用申請情報

#### 犬関連
- **dogs**: 犬の基本情報
- **vaccination_records**: ワクチン接種履歴

#### 投稿関連
- **posts**: 投稿情報
- **post_images**: 投稿画像
- **comments**: コメント
- **likes**: いいね
- **hashtags**: ハッシュタグ
- **post_hashtags**: 投稿-ハッシュタグ関連

#### イベント関連
- **events**: イベント情報
- **event_registrations**: イベント参加登録

#### 施設管理関連
- **business_hours**: 営業時間
- **special_holidays**: 特別休業日
- **entry_logs**: 入退場記録
- **announcements**: お知らせ
- **system_settings**: システム設定

#### ログ関連
- **admin_logs**: 管理者操作ログ

## 5. 非機能要件

### 5.1 パフォーマンス要件
- ページ読み込み時間: 3秒以内
- API応答時間: 1秒以内
- 同時接続数: 100ユーザー以上

### 5.2 セキュリティ要件
- HTTPS通信の強制
- パスワードのハッシュ化（bcrypt）
- JWTトークンによる認証
- CORS設定による不正アクセス防止
- SQLインジェクション対策
- XSS対策

### 5.3 可用性要件
- サービス稼働率: 99.5%以上
- データバックアップ: 日次
- 障害復旧時間: 4時間以内

### 5.4 ユーザビリティ要件
- レスポンシブデザイン（モバイルファースト）
- 直感的なUI/UX
- 日本語対応
- エラーメッセージの分かりやすさ

### 5.5 保守性要件
- コードの可読性とドキュメント化
- モジュール化された構造
- 自動テストの実装
- ログ出力とモニタリング

## 6. 制約事項

### 6.1 技術的制約
- ブラウザ対応: Chrome, Safari, Firefox, Edge（最新版）
- モバイル対応: iOS 14以上、Android 10以上

### 6.2 運用制約
- 開発期間: 3ヶ月
- 初期リリース後の段階的機能追加

## 7. 今後の拡張予定機能

### 7.1 予約システム
- 時間帯別の予約管理
- 定期予約機能
- キャンセル待ち機能

### 7.2 決済機能
- オンライン決済（クレジットカード、電子マネー）
- 月額会員制度
- ポイントシステム

### 7.3 AI機能
- 犬の相性診断
- 画像認識による犬種判定
- チャットボットによる問い合わせ対応

### 7.4 IoT連携
- 入退場ゲートの自動化
- リアルタイム混雑状況表示
- 環境センサーによる気象情報提供

## 8. プロジェクト体制

### 8.1 開発チーム
- プロジェクトマネージャー: 1名
- バックエンド開発者: 1-2名
- フロントエンド開発者: 1-2名
- デザイナー: 1名
- テスター: 1名

### 8.2 ステークホルダー
- 施設運営者
- 今治市関係者
- 利用者代表

## 9. スケジュール

### フェーズ1（1ヶ月目）
- 要件定義の確定
- 基本設計
- 開発環境構築

### フェーズ2（2ヶ月目）
- コア機能の実装
  - ユーザー認証
  - 申請管理
  - 基本的な管理機能

### フェーズ3（3ヶ月目）
- 追加機能の実装
  - SNS機能
  - イベント管理
  - 入場管理
- テスト・デバッグ
- 本番環境デプロイ

## 10. リスク管理

### 10.1 技術的リスク
- **リスク**: 新技術の学習コスト
- **対策**: 事前の技術調査と プロトタイプ作成

### 10.2 スケジュールリスク
- **リスク**: 機能追加による開発遅延
- **対策**: MVP（最小限の製品）の明確化と段階的リリース

### 10.3 セキュリティリスク
- **リスク**: 個人情報漏洩
- **対策**: セキュリティ監査の実施と定期的な脆弱性診断

## 11. 成功指標（KPI）

### 11.1 利用者数
- 月間アクティブユーザー数: 100名以上
- 新規登録者数: 月20名以上

### 11.2 システム稼働率
- 稼働率: 99.5%以上
- 平均応答時間: 1秒以内

### 11.3 ユーザー満足度
- アプリ評価: 4.0以上（5段階評価）
- 問い合わせ件数の削減: 50%減

## 12. 備考

本要件定義書は、プロジェクトの進行に応じて適宜更新される可能性があります。変更がある場合は、関係者全員に通知し、合意を得た上で更新を行います。

---

**文書情報**
- バージョン: 1.0
- 作成日: 2025年1月19日
- 作成者: 里山ドッグラン開発チーム
- 最終更新日: 2025年1月19日