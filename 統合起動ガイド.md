# 里山ドッグラン統合起動ガイド

## 📋 プロジェクト概要

各チームの実装が完了し、統合された里山ドッグラン管理システムです。

### 実装済み機能
- **バックエンド**: FastAPI + Supabase (41エンドポイント)
- **フロントエンド管理画面**: Next.js (Port 3002)
- **フロントエンドユーザー画面**: Next.js (Port 3001)
- **デザインシステム**: WCAG 2.1 AA準拠

---

## 🚀 クイックスタート

### ワンクリック起動
```bash
./start-dev.sh
```

起動後、以下のURLで各サービスにアクセスできます：
- **ユーザー画面**: http://localhost:3001
- **管理画面**: http://localhost:3002/admin
- **API文書**: http://localhost:8000/docs

---

## 🔧 手動セットアップ

### 1. 必要な環境
- Python 3.8+
- Node.js 18+
- Supabaseアカウント

### 2. 初回セットアップ

#### バックエンド環境
```bash
cd backend/
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt

# 環境変数設定
cp .env.example .env
# .envファイルを編集してSupabase情報を入力
```

#### フロントエンド環境
```bash
cd frontend/
npm install

# 環境変数設定  
cp .env.local.example .env.local
# .env.localファイルを編集してSupabase情報を入力
```

### 3. Supabaseデータベース設定

1. **Supabaseダッシュボード** にログイン
2. **SQL Editor** で以下を順次実行：
   - `database_schema.sql`
   - `supabase_rls_policies.sql`
   - `create_admin_user.sql`

3. **管理者アカウント作成**
   - Authentication → Users → Add user
   - Email: `kynk.0222@gmail.com`
   - Auto Confirm User: チェック

### 4. 各サーバーの個別起動

```bash
# Terminal 1: バックエンドAPI
cd backend/
source venv/bin/activate
./run_dev.sh

# Terminal 2: ユーザー画面  
cd frontend/
npm run dev

# Terminal 3: 管理画面
cd frontend/
PORT=3002 npm run dev
```

---

## 🌐 アクセス情報

| サービス | URL | ポート | 説明 |
|---------|-----|--------|------|
| ユーザー画面 | http://localhost:3001 | 3001 | 一般ユーザー向けインターフェース |
| 管理画面 | http://localhost:3002/admin | 3002 | 管理者向けダッシュボード |
| バックエンドAPI | http://localhost:8000 | 8000 | REST API サーバー |
| API文書 | http://localhost:8000/docs | 8000 | Swagger UI |
| Supabase | https://hoechpkznbpavyozjqni.supabase.co | - | データベース・認証 |

---

## 🔑 認証情報

### 管理者アカウント
- **Email**: `kynk.0222@gmail.com`
- **Password**: Supabaseで設定したパスワード
- **アクセス先**: http://localhost:3002/admin/login

### 開発用ユーザーアカウント
- 新規登録: http://localhost:3001/register
- ログイン: http://localhost:3001/login

---

## 📁 ディレクトリ構造

```
里山ドッグラン3/
├── backend/                 # FastAPI バックエンド
│   ├── app/                # アプリケーションコード
│   ├── requirements.txt    # Python依存関係
│   ├── run_dev.sh         # 開発サーバー起動
│   └── .env               # 環境変数（要設定）
├── frontend/               # Next.js フロントエンド
│   ├── app/               # アプリケーションページ
│   ├── components/        # UIコンポーネント
│   ├── package.json       # Node.js依存関係
│   └── .env.local         # 環境変数（要設定）
├── design-system/          # UI/UXデザインシステム
├── start-dev.sh           # ワンクリック起動スクリプト
└── 統合起動ガイド.md        # このファイル
```

---

## 🛠 開発ワークフロー

### 1. 通常の開発
```bash
# 開発開始
./start-dev.sh

# 開発完了後、各ターミナルでCtrl+C
```

### 2. バックエンド開発
```bash
cd backend/
source venv/bin/activate
./run_dev.sh

# API文書確認: http://localhost:8000/docs
```

### 3. フロントエンド開発（ユーザー画面）
```bash
cd frontend/
npm run dev

# 確認: http://localhost:3001
```

### 4. フロントエンド開発（管理画面）
```bash
cd frontend/
PORT=3002 npm run dev

# 確認: http://localhost:3002/admin
```

---

## 🔍 動作確認チェックリスト

### 基本動作
- [ ] バックエンドAPI起動 (http://localhost:8000/docs)
- [ ] ユーザー画面表示 (http://localhost:3001)
- [ ] 管理画面表示 (http://localhost:3002/admin)

### 認証機能
- [ ] 管理者ログイン
- [ ] ユーザー新規登録
- [ ] ユーザーログイン

### API連携
- [ ] Supabaseデータベース接続
- [ ] 認証トークン発行
- [ ] API レスポンス確認

### UI/UX
- [ ] レスポンシブデザイン
- [ ] FC今治ブランドカラー適用
- [ ] アクセシビリティ対応

---

## 🚨 トラブルシューティング

### よくある問題

#### "ポートが使用中です" エラー
```bash
# ポート使用状況確認
lsof -i :3001
lsof -i :3002  
lsof -i :8000

# プロセス終了
kill -9 [PID]
```

#### "Supabase接続エラー"
1. `.env` と `.env.local` のURL・Keyを確認
2. Supabaseダッシュボードでプロジェクト状態確認
3. データベーススキーマが正しく適用されているか確認

#### "依存関係エラー"
```bash
# Python依存関係再インストール
cd backend/
pip install -r requirements.txt

# Node.js依存関係再インストール
cd frontend/
rm -rf node_modules package-lock.json
npm install
```

#### "管理者ログインできない"
1. Supabase Authentication → Users で管理者アカウント確認
2. `admin_users` テーブルにレコードが存在するか確認
3. パスワードをSupabaseダッシュボードでリセット

---

## 📊 システム構成図

```
[ユーザー]
    ↓
[ユーザー画面:3001] ←→ [管理画面:3002]
    ↓                      ↓
[バックエンドAPI:8000]
    ↓
[Supabase Database + Auth + Storage]
```

---

## 📚 関連ドキュメント

- `実装完了報告書_バックエンドエンジニア.md` - API仕様詳細
- `完了報告書_フロントエンドエンジニアA.md` - 管理画面仕様
- `実装完了報告書_フロントエンドB.md` - ユーザー画面仕様
- `UI_UXデザイナー_完了報告書.md` - デザインシステム仕様
- `setup_instructions.md` - Supabase詳細設定

---

## 🎯 次のステップ

1. **本番環境デプロイ**
   - Vercel設定
   - 環境変数設定
   - ドメイン設定

2. **機能テスト**
   - ユーザー受け入れテスト
   - パフォーマンステスト
   - セキュリティテスト

3. **運用準備**
   - 監視設定
   - ログ設定
   - バックアップ設定

---

**🎉 統合完了！今治市の愛犬家の皆様に素晴らしいサービスを提供する準備が整いました。**